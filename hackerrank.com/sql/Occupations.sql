select max(doctor),max(professor),max(singer),max(actor) from ( select row_number() over(partition by occupation order by name) as id, case when occupation='Doctor' then name else null end as doctor, case when occupation='Professor' then name else null end as Professor, case when occupation='Singer' then name else null end as Singer, case when occupation='Actor' then name else null end as Actor from occupations )temp group by id